"'Duplicate Test Set_3' As CommandComponent":
    AutoSave: =true
    DataSource: ='Copilot Test Sets'
    Fill: =RGBA(0, 0, 0, 0)
    Height: =0
    Icon: =SampleImage
    OnSelect: |
        =If(
            Confirm(
                "Do you want to copy this test set and all of its associated tests?",
                {
                    Title: "Duplicate Test Set Confirmation",
                    ConfirmButton: "Yes",
                    CancelButton: "No"
                }
            ),
            IfError(
                Notify("Copy is in progress. Please wait.");
                With(
                    {
                        // Create the new Test Set record using the selected (i.e.,Self) record
                        clonedTestSet: Patch(
                            'Copilot Test Sets',
                            Defaults('Copilot Test Sets'),
                            {Name: Self.Selected.Item.Name & " (Copy)"}
                        )
                    },
                    // Fetch the associated active Tests of selected Test Set
                    With(
                        {
                            childTests: Filter(
                                'Copilot Tests',
                                'Copilot Test Set'.'Copilot Test Set' = Self.Selected.Item.'Copilot Test Set' && Status = 'Status (Copilot Tests)'.Active
                            )
                        },
                        Notify("Copilot Tests Count: " & CountRows(childTests));
                        // Create the new Tests using the retrived childTests
                        ForAll(
                            childTests,
                            Patch(
                                'Copilot Tests',
                                Defaults('Copilot Tests'),
                                {
                                    Name: ThisRecord.Name,
                                    'Copilot Test Set': clonedTestSet,
                                    'Test Type': ThisRecord.'Test Type',
                                    'Seconds Before Getting Answer': ThisRecord.'Seconds Before Getting Answer',
                                    'Send startConversation Event': ThisRecord.'Send startConversation Event',
                                    'Expected Position of the Response Message': ThisRecord.'Expected Position of the Response Message',
                                    'Test Utterance': ThisRecord.'Test Utterance',
                                    'Expected Response': ThisRecord.'Expected Response',
                                    'External Variables JSON': ThisRecord. 'External Variables JSON',
                                    'Expected Generative Answers Outcome': ThisRecord.'Expected Generative Answers Outcome',
                                    'Expected Topic Name': ThisRecord.'Expected Topic Name',
                                    'Expected Attachments JSON': ThisRecord.'Expected Attachments JSON'
                                }
                            )
                        )
                    );
                    // Navigate to the cloned record    
                    Navigate(clonedTestSet);            
                ),
                Notify(
                    "An error occurred while copying test sets & associated tests. Please try again.",
                    NotificationType.Error
                ),
                Notify(
                        "Copilot Test Set record has been copied successfully.",
                        NotificationType.Success
                )
            )
        );
    Selected: |-
        ={ Item: {}, AllItems:[], Unsaved: false, State: SelectedState.Edit }
    SelectionMax: =100
    SelectionMin: =100
    Title: = 
    Tooltip: = 
    Visible: =Self.Selected.State <> FormMode.New
    Width: =0
    X: =0
    Y: =0
    ZIndex: =1

